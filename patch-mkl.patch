From d7cf4a2445eb10e0de4908f5659674b3a8cc823e Mon Sep 17 00:00:00 2001
From: Maarten Arnst <maarten.arnst@uliege.be>
Date: Wed, 16 Mar 2022 16:42:05 +0100
Subject: [PATCH] Patch solves compilation error observed when linking with
 Intel One API MKL version >= 2021.

---
 packages/stokhos/src/Stokhos_SDMUtils.hpp | 14 ++++++++++++--
 1 file changed, 12 insertions(+), 2 deletions(-)

diff --git a/packages/stokhos/src/Stokhos_SDMUtils.hpp b/packages/stokhos/src/Stokhos_SDMUtils.hpp
index d93319320aa..b978b44c639 100644
--- a/packages/stokhos/src/Stokhos_SDMUtils.hpp
+++ b/packages/stokhos/src/Stokhos_SDMUtils.hpp
@@ -50,9 +50,19 @@
 #include <ostream>
 
 #define DGEQP3_F77  F77_BLAS_MANGLE(dgeqp3,DGEQP3)
+#if defined(INTEL_MKL)
+    #include "mkl_version.h"
+#endif
+
 extern "C" {
-void DGEQP3_F77(const int*, const int*, double*, const int*, int*,
-                double*, double*, const int*, int*);
+#if defined(INTEL_MKL) && __INTEL_MKL__ >= 2021
+    // MKL defines NOTHROW
+    void DGEQP3_F77(const int*, const int*, double*, const int*, int*,
+                double*, double*, const int*, int*) NOTHROW;
+#else
+    void DGEQP3_F77(const int*, const int*, double*, const int*, int*,
+            double*, double*, const int*, int*);
+#endif
 }
 
 #include "Stokhos_ConfigDefs.h"
-- 
2.25.1

